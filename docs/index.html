<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Penalized Regression with Hierarchical Nested Parameterization Structure • hierNest</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Penalized Regression with Hierarchical Nested Parameterization Structure">
<meta name="description" content="Efficient implementation of penalized regression with hierarchical nested parametrization for grouped data. The package provides penalized regression methods that decompose subgroup-specific covariate effects into shared global effects, Major subgroup–specific effects, and Minor subgroup–specific effects, enabling structured borrowing of information across related clinical subgroups. Both lasso and hierarchical overlapping group lasso penalties are supported to encourage sparsity while respecting the nested subgroup structure. Efficient computation is achieved through a modified design matrix representation and a custom majorization–minimization algorithm for overlapping group penalties.">
<meta property="og:description" content="Efficient implementation of penalized regression with hierarchical nested parametrization for grouped data. The package provides penalized regression methods that decompose subgroup-specific covariate effects into shared global effects, Major subgroup–specific effects, and Minor subgroup–specific effects, enabling structured borrowing of information across related clinical subgroups. Both lasso and hierarchical overlapping group lasso penalties are supported to encourage sparsity while respecting the nested subgroup structure. Efficient computation is achieved through a modified design matrix representation and a custom majorization–minimization algorithm for overlapping group penalties.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">hierNest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav"></ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="hiernest">hierNest<a class="anchor" aria-label="anchor" href="#hiernest"></a>
</h1></div>
<p>The <code>hierNest</code> package allows for the fitting of penalized GLMs with covariate effects that vary by discrete and hierarchically-organized groups. The methodology allows for the shrinkage of group-specific models to a global model or to higher level groups. For example, if groups are defined based on primary diagnoses and then diagnoses are organized into body systems, <code>hierNest</code> will allow models to vary for each diagnosis or could be collapsed via penalization to body-system specific models or fully to a global model in common for all groups, all on a variable-by-variable basis.</p>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>Load the package and an example dataset</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jaredhuling.org/hierNest/">hierNest</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"example_data"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ X        : num [1:200, 1:30] -1.715 1.001 -1.551 -0.214 0.616 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : NULL</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:30] "X1" "X2" "X3" "X4" ...</span></span>
<span><span class="co">#&gt;  $ Y        : num [1:200] 0 1 0 1 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ hier_info: num [1:200, 1:2] 1 1 1 1 1 1 1 1 1 1 ...</span></span></code></pre></div>
<p>The data structure <code>hier_info</code> contains hierarchical information about group membership. The last column represents the finest description of group membership (eg primary diagnosis) and the first column represents the coarsest definition of group (eg body system).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">$</span><span class="va">hier_info</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    1    1</span></span>
<span><span class="co">#&gt; [2,]    1    1</span></span>
<span><span class="co">#&gt; [3,]    1    1</span></span>
<span><span class="co">#&gt; [4,]    1    1</span></span>
<span><span class="co">#&gt; [5,]    1    1</span></span>
<span><span class="co">#&gt; [6,]    1    1</span></span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="fit-models-and-select-tuning-parameters-via-cross-validation">Fit models and select tuning parameters via cross-validation<a class="anchor" aria-label="anchor" href="#fit-models-and-select-tuning-parameters-via-cross-validation"></a>
</h1>
<p>The <code><a href="reference/cv.hierNest.html">cv.hierNest()</a></code> function both fits models and selects tuning parameters via <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-fold cross validation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv.fit</span><span class="op">=</span><span class="fu"><a href="reference/cv.hierNest.html">cv.hierNest</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">$</span><span class="va">X</span>,</span>
<span>                   <span class="va">example_data</span><span class="op">$</span><span class="va">Y</span>,</span>
<span>                   method<span class="op">=</span><span class="st">"overlapping"</span>,<span class="co"># For now, we only wrap-up the overlapping group lasso method in this function</span></span>
<span>                   hier_info<span class="op">=</span><span class="va">example_data</span><span class="op">$</span><span class="va">hier_info</span>,</span>
<span>                   family<span class="op">=</span><span class="st">"binomial"</span>,</span>
<span>                   partition <span class="op">=</span> <span class="st">"subgroup"</span>, <span class="co"># partition = "subgroup" make sure the each n-fold is sampled within the subgroups to avoid extreme cases</span></span>
<span>                   cvmethod <span class="op">=</span> <span class="st">"grid_search"</span>, <span class="co"># cvmethod = "grid_search" indicate the second cross-validation method</span></span>
<span>                   asparse1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">20</span><span class="op">)</span>, <span class="co"># Input the upper and lower bounds of alpha_1 and alpha_2</span></span>
<span>                   asparse2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.20</span><span class="op">)</span>, </span>
<span>                   asparse1_num <span class="op">=</span> <span class="fl">3</span>, <span class="co"># number of grids for alpha_1 and alpha_2, total 3*3 = 9 grids will be screened</span></span>
<span>                   asparse2_num <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                   nlambda <span class="op">=</span> <span class="fl">50</span>, <span class="co"># length of lambda sequence for each pair of alpha_1 and alpha_2</span></span>
<span>                   <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h1>
<div class="section level2">
<h2 id="plot-the-coefficients">Plot the coefficients<a class="anchor" aria-label="anchor" href="#plot-the-coefficients"></a>
</h2>
<p>By specifying the type = “coefficients”, we plot all non-zero coefficient including the overall mean, group-specific, and subgroup specific.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv.fit</span>, type <span class="op">=</span> <span class="st">"coefficients"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-3-1.png"><!-- --></p>
<p>By specifying the type = “Subgroup effect”, we plot the covariate effects for each subgroup.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv.fit</span>, type <span class="op">=</span> <span class="st">"Subgroup effects"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-4-1.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="grab-chosen-lambda-and-coefficients">Grab chosen lambda and coefficients<a class="anchor" aria-label="anchor" href="#grab-chosen-lambda-and-coefficients"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv.fit</span><span class="op">$</span><span class="va">lambda.min</span>    <span class="co"># lambda minimizing CV loss</span></span>
<span><span class="co">#&gt; [1] 0.00056551</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv.fit</span><span class="op">$</span><span class="va">min_alpha1</span>    <span class="co"># alpha1 minimizing CV loss</span></span>
<span><span class="co">#&gt; [1] 0.5</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv.fit</span><span class="op">$</span><span class="va">min_alpha2</span>    <span class="co"># lambda minimizing CV loss</span></span>
<span><span class="co">#&gt; [1] 0.2</span></span></code></pre></div>
</div>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing hierNest</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ziren Jiang <br><small class="roles"> Author, maintainer </small>   </li>
<li>Jared Huling <br><small class="roles"> Author </small>   </li>
<li>Jue Hou <br><small class="roles"> Author </small>   </li>
<li>Lingfeng Huo <br><small class="roles"> Author </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ziren Jiang, Jared Huling, Jue Hou, Lingfeng Huo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
