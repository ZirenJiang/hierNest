<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Penalized Regression with Hierarchical Nested Parameterization Structure • hierNest</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Penalized Regression with Hierarchical Nested Parameterization Structure">
<meta property="og:description" content="Efficient implementation of penalized regression with hierarchical nested parametrization for grouped data. The package provides penalized regression methods that decompose subgroup-specific covariate effects into shared global effects, Major subgroup–specific effects, and Minor subgroup–specific effects, enabling structured borrowing of information across related clinical subgroups. Both lasso and hierarchical overlapping group lasso penalties are supported to encourage sparsity while respecting the nested subgroup structure. Efficient computation is achieved through a modified design matrix representation and a custom majorization–minimization algorithm for overlapping group penalties.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">hierNest</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="hiernest">hierNest<a class="anchor" aria-label="anchor" href="#hiernest"></a>
</h1></div>
<p>The <code>hierNest</code> package allows for the fitting of penalized GLMs with covariate effects that vary by discrete and hierarchically-organized groups. The methodology allows for the shrinkage of group-specific models to a global model or to higher level groups. For example, if groups are defined based on primary diagnoses and then diagnoses are organized into body systems, <code>hierNest</code> will allow models to vary for each diagnosis or could be collapsed via penalization to body-system specific models or fully to a global model in common for all groups, all on a variable-by-variable basis.</p>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>Load the package and an example dataset</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">hierNest</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"example_data"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ X        : num [1:200, 1:30] -1.715 1.001 -1.551 -0.214 0.616 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : NULL</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:30] "X1" "X2" "X3" "X4" ...</span></span>
<span><span class="co">#&gt;  $ Y        : num [1:200] 0 1 0 1 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ hier_info: num [1:200, 1:2] 1 1 1 1 1 1 1 1 1 1 ...</span></span></code></pre></div>
<p>The data structure <code>hier_info</code> contains hierarchical information about group membership. The last column represents the finest description of group membership (eg primary diagnosis) and the first column represents the coarsest definition of group (eg body system).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">$</span><span class="va">hier_info</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    1    1</span></span>
<span><span class="co">#&gt; [2,]    1    1</span></span>
<span><span class="co">#&gt; [3,]    1    1</span></span>
<span><span class="co">#&gt; [4,]    1    1</span></span>
<span><span class="co">#&gt; [5,]    1    1</span></span>
<span><span class="co">#&gt; [6,]    1    1</span></span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="fit-models-and-select-tuning-parameters-via-cross-validation">Fit models and select tuning parameters via cross-validation<a class="anchor" aria-label="anchor" href="#fit-models-and-select-tuning-parameters-via-cross-validation"></a>
</h1>
<p>The <code><a href="reference/cv.hierNest.html">cv.hierNest()</a></code> function both fits models and selects tuning parameters via <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>-fold cross validation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv.fit</span><span class="op">=</span><span class="fu"><a href="reference/cv.hierNest.html">cv.hierNest</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">$</span><span class="va">X</span>,</span>
<span>                   <span class="va">example_data</span><span class="op">$</span><span class="va">Y</span>,</span>
<span>                   method<span class="op">=</span><span class="st">"overlapping"</span>,<span class="co"># For now, we only wrap-up the overlapping group lasso method in this function</span></span>
<span>                   hier_info<span class="op">=</span><span class="va">example_data</span><span class="op">$</span><span class="va">hier_info</span>,</span>
<span>                   family<span class="op">=</span><span class="st">"binomial"</span>,</span>
<span>                   partition <span class="op">=</span> <span class="st">"subgroup"</span>, <span class="co"># partition = "subgroup" make sure the each n-fold is sampled within the subgroups to avoid extreme cases</span></span>
<span>                   cvmethod <span class="op">=</span> <span class="st">"grid_search"</span>, <span class="co"># cvmethod = "grid_search" indicate the second cross-validation method</span></span>
<span>                   asparse1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">20</span><span class="op">)</span>, <span class="co"># Input the upper and lower bounds of alpha_1 and alpha_2</span></span>
<span>                   asparse2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.20</span><span class="op">)</span>, </span>
<span>                   asparse1_num <span class="op">=</span> <span class="fl">3</span>, <span class="co"># number of grids for alpha_1 and alpha_2, total 3*3 = 9 grids will be screened</span></span>
<span>                   asparse2_num <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                   nlambda <span class="op">=</span> <span class="fl">50</span>, <span class="co"># length of lambda sequence for each pair of alpha_1 and alpha_2</span></span>
<span>                   <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h1>
<div class="section level2">
<h2 id="plot-the-coefficients">Plot the coefficients<a class="anchor" aria-label="anchor" href="#plot-the-coefficients"></a>
</h2>
<p>By specifying the type = “coefficients”, we plot all non-zero coefficient including the overall mean, group-specific, and subgroup specific.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv.fit</span>, type <span class="op">=</span> <span class="st">"coefficients"</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-6635e9b85f61e36efe7e" class="plotly html-widget html-fill-item" style="width:100%;height:480px;">

</div>
<script type="application/json" data-for="htmlwidget-6635e9b85f61e36efe7e">{"x":{"visdat":{"5462288d6f8f":["function () ","plotlyVisDat"]},"cur_data":"5462288d6f8f","attrs":{"5462288d6f8f":{"x":{},"y":{},"z":{},"colorscale":[["0","red"],["0.5","white"],["1","blue"]],"zmin":-0.7220898635785945,"zmax":0.7220898635785945,"colorbar":{"title":"Value"},"showscale":true,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Predictors","tickmode":"array","tickvals":[1,2,3,4,5,6,7],"ticktext":["X30","X13","Intercept","X14","X24","X9","X29"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Subgroup effects","autorange":"reversed","tickmode":"array","tickvals":[1,2,3,4,5,6,7],"ticktext":["Overall mean effect","Group 1","Subgroup 1","Subgroup 2","Group 2","Subgroup 3","Subgroup 4"]},"scene":{"zaxis":{"title":"plot_val"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"Value","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","red"],["0.5","white"],["1","blue"]],"showscale":true,"x":[1,1,1,1,1,1,1,2,2,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,4,5,5,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,7],"y":[1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7],"z":[0.20677216030794571,-1.1971951163041602e-05,null,-0.0013575926539857004,0.19741206934129724,0.17846096622484275,0.013486494126654505,0.16892263064949464,null,-0.11592928123269229,0.10423637709566766,null,-0.043337964711142977,0.27885448256039774,-2.1981168646739588,null,null,null,0.33538033117411348,0.7226783474397187,null,-0.33309255904032808,-0.12847564929953931,null,-0.39736830044349042,null,null,null,0.27447673947992024,null,null,null,0.043974767057071484,0.18857021584815697,null,-0.19641253358941496,null,null,null,null,null,null,0.71090867021723503,null,null,null,null,null,null],"zmin":-0.7220898635785945,"zmax":0.7220898635785945,"type":"heatmap","xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>By specifying the type = “Subgroup effect”, we plot the covaraite effects for each subgroup.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv.fit</span>, type <span class="op">=</span> <span class="st">"Subgroup effects"</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-ebc1f8007de088e60f40" class="plotly html-widget html-fill-item" style="width:100%;height:480px;">

</div>
<script type="application/json" data-for="htmlwidget-ebc1f8007de088e60f40">{"x":{"visdat":{"546264b4e8da":["function () ","plotlyVisDat"]},"cur_data":"546264b4e8da","attrs":{"546264b4e8da":{"x":{},"y":{},"z":{},"colorscale":[["0","red"],["0.5","white"],["1","blue"]],"zmin":-2.0807337487630186,"zmax":2.0807337487630186,"colorbar":{"title":"Value"},"showscale":true,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Predictors","tickmode":"array","tickvals":[1,2,3,4,5,6,7],"ticktext":["Intercept","X9","X13","X14","X24","X29","X30"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Subgroup effects","autorange":"reversed","tickmode":"array","tickvals":[1,2,3,4],"ticktext":["Sub-Group 1","Sub-Group 2","Sub-Group 3","Sub-Group 4"]},"scene":{"zaxis":{"title":"plot_val"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"Value","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","red"],["0.5","white"],["1","blue"]],"showscale":true,"x":[1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7],"y":[1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4],"z":[-2.1981168646739588,-2.1981168646739588,-1.1400581860601267,-1.8627365334998454,-0.19641253358941496,-0.19641253358941496,-0.19641253358941496,-0.19641253358941496,0.052993349416802352,0.27315900774516233,0.12558466593835166,0.44777711320989239,-0.46156820833986739,-0.85893650878335781,-0.33309255904032808,-0.33309255904032808,0.27447673947992024,0.27447673947992024,0.50702172238514875,0.31845150653699172,0.71090867021723503,0.71090867021723503,0.71090867021723503,0.71090867021723503,0.20676018835678267,0.20540259570279698,0.5826451958740857,0.41767072377589742],"zmin":-2.0807337487630186,"zmax":2.0807337487630186,"type":"heatmap","xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="grab-chosen-lambda-and-coefficients">Grab chosen lambda and coefficients<a class="anchor" aria-label="anchor" href="#grab-chosen-lambda-and-coefficients"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv.fit</span><span class="op">$</span><span class="va">lambda.min</span>    <span class="co"># lambda minimizing CV loss</span></span>
<span><span class="co">#&gt; [1] 0.0008235796</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv.fit</span><span class="op">$</span><span class="va">min_alpha1</span>    <span class="co"># alpha1 minimizing CV loss</span></span>
<span><span class="co">#&gt; [1] 0.5</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv.fit</span><span class="op">$</span><span class="va">min_alpha2</span>    <span class="co"># lambda minimizing CV loss</span></span>
<span><span class="co">#&gt; [1] 0.2</span></span></code></pre></div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing hierNest</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ziren Jiang <br><small class="roles"> Author, maintainer </small>   </li>
<li>Jared Huling <br><small class="roles"> Author </small>   </li>
<li>Jue Hou <br><small class="roles"> Author </small>   </li>
<li>Lingfeng Huo <br><small class="roles"> Author </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Ziren Jiang, Jared Huling, Jue Hou, Lingfeng Huo.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
