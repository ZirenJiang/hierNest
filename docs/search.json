[{"path":"https://jaredhuling.github.io/hierNest/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Ziren Jiang. Author, maintainer. Jared Huling. Author. Jue Hou. Author. Lingfeng Huo. Author. Daniel J. McDonald. Contributor. Xiaoxuan Liang. Contributor. Anibal Solón Heinsfeld. Contributor. Aaron Cohen. Contributor. Yi Yang. Contributor. Hui Zou. Contributor. Jerome Friedman. Contributor. Trevor Hastie. Contributor. Rob Tibshirani. Contributor. Balasubramanian Narasimhan. Contributor. Kenneth Tay. Contributor. Noah Simon. Contributor. Junyang Qian. Contributor. James Yang. Contributor.","code":""},{"path":"https://jaredhuling.github.io/hierNest/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Jiang Z, Huling J, Hou J, Huo L (2026). hierNest: Penalized Regression Hierarchical Nested Parameterization Structure. R package version 1.0.3, https://jaredhuling.github.io/hierNest/.","code":"@Manual{,   title = {hierNest: Penalized Regression with Hierarchical Nested Parameterization Structure},   author = {Ziren Jiang and Jared Huling and Jue Hou and Lingfeng Huo},   year = {2026},   note = {R package version 1.0.3},   url = {https://jaredhuling.github.io/hierNest/}, }"},{"path":"https://jaredhuling.github.io/hierNest/index.html","id":"hiernest","dir":"","previous_headings":"","what":"Penalized Regression with Hierarchical Nested Parameterization Structure","title":"Penalized Regression with Hierarchical Nested Parameterization Structure","text":"hierNest package allows fitting penalized GLMs covariate effects vary discrete hierarchically-organized groups. methodology allows shrinkage group-specific models global model higher level groups. example, groups defined based primary diagnoses diagnoses organized body systems, hierNest allow models vary diagnosis collapsed via penalization body-system specific models fully global model common groups, variable--variable basis.","code":""},{"path":"https://jaredhuling.github.io/hierNest/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Penalized Regression with Hierarchical Nested Parameterization Structure","text":"Load package example dataset data structure hier_info contains hierarchical information group membership. last column represents finest description group membership (eg primary diagnosis) first column represents coarsest definition group (eg body system).","code":"library(hierNest)  data(\"example_data\")  str(example_data) #> List of 3 #>  $ X        : num [1:200, 1:30] -1.715 1.001 -1.551 -0.214 0.616 ... #>   ..- attr(*, \"dimnames\")=List of 2 #>   .. ..$ : NULL #>   .. ..$ : chr [1:30] \"X1\" \"X2\" \"X3\" \"X4\" ... #>  $ Y        : num [1:200] 0 1 0 1 0 0 0 0 0 0 ... #>  $ hier_info: num [1:200, 1:2] 1 1 1 1 1 1 1 1 1 1 ... head(example_data$hier_info) #>      [,1] [,2] #> [1,]    1    1 #> [2,]    1    1 #> [3,]    1    1 #> [4,]    1    1 #> [5,]    1    1 #> [6,]    1    1"},{"path":"https://jaredhuling.github.io/hierNest/index.html","id":"fit-models-and-select-tuning-parameters-via-cross-validation","dir":"","previous_headings":"","what":"Fit models and select tuning parameters via cross-validation","title":"Penalized Regression with Hierarchical Nested Parameterization Structure","text":"cv.hierNest() function fits models selects tuning parameters via KK-fold cross validation.","code":"cv.fit=cv.hierNest(example_data$X,                    example_data$Y,                    method=\"overlapping\",# For now, we only wrap-up the overlapping group lasso method in this function                    hier_info=example_data$hier_info,                    family=\"binomial\",                    partition = \"subgroup\", # partition = \"subgroup\" make sure the each n-fold is sampled within the subgroups to avoid extreme cases                    cvmethod = \"grid_search\", # cvmethod = \"grid_search\" indicate the second cross-validation method                    asparse1 = c(0.5,20), # Input the upper and lower bounds of alpha_1 and alpha_2                    asparse2 = c(0.05,0.20),                     asparse1_num = 3, # number of grids for alpha_1 and alpha_2, total 3*3 = 9 grids will be screened                    asparse2_num = 3,                     nlambda = 50, # length of lambda sequence for each pair of alpha_1 and alpha_2                    )"},{"path":[]},{"path":"https://jaredhuling.github.io/hierNest/index.html","id":"plot-the-coefficients","dir":"","previous_headings":"","what":"Plot the coefficients","title":"Penalized Regression with Hierarchical Nested Parameterization Structure","text":"specifying type = “coefficients”, plot non-zero coefficient including overall mean, group-specific, subgroup specific.  specifying type = “Subgroup effect”, plot covariate effects subgroup.","code":"plot(cv.fit, type = \"coefficients\") plot(cv.fit, type = \"Subgroup effects\")"},{"path":"https://jaredhuling.github.io/hierNest/index.html","id":"grab-chosen-lambda-and-coefficients","dir":"","previous_headings":"","what":"Grab chosen lambda and coefficients","title":"Penalized Regression with Hierarchical Nested Parameterization Structure","text":"","code":"cv.fit$lambda.min    # lambda minimizing CV loss #> [1] 0.00056551 cv.fit$min_alpha1    # alpha1 minimizing CV loss #> [1] 0.5 cv.fit$min_alpha2    # lambda minimizing CV loss #> [1] 0.2"},{"path":"https://jaredhuling.github.io/hierNest/reference/coef.cv.sparsegl.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract coefficients from a `cv.sparsegl` object. — coef.cv.sparsegl","title":"Extract coefficients from a `cv.sparsegl` object. — coef.cv.sparsegl","text":"function etracts coefficients cross-validated [sparsegl()] model, using stored `\"sparsegl.fit\"` object, optimal value chosen `lambda`.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/coef.cv.sparsegl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract coefficients from a `cv.sparsegl` object. — coef.cv.sparsegl","text":"","code":"# S3 method for class 'cv.sparsegl' coef(object, s = c(\"lambda.1se\", \"lambda.min\"), ...)"},{"path":"https://jaredhuling.github.io/hierNest/reference/coef.cv.sparsegl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract coefficients from a `cv.sparsegl` object. — coef.cv.sparsegl","text":"object Fitted [cv.sparsegl()] object. s Value(s) penalty parameter `lambda` coefficients desired. Default single value `s = \"lambda.1se\"` stored CV object (corresponding largest value `lambda` CV error estimate within 1 standard error minimum). Alternatively `s = \"lambda.min\"` can used (corresponding minimum cross validation error estimate). `s` numeric, taken value(s) `lambda` used. ... used.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/coef.cv.sparsegl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract coefficients from a `cv.sparsegl` object. — coef.cv.sparsegl","text":"coefficients requested value(s) `lambda`.","code":""},{"path":[]},{"path":"https://jaredhuling.github.io/hierNest/reference/coef.sparsegl.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract model coefficients from a `sparsegl` object. — coef.sparsegl","title":"Extract model coefficients from a `sparsegl` object. — coef.sparsegl","text":"Computes coefficients requested value(s) `lambda` [sparsegl()] object.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/coef.sparsegl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract model coefficients from a `sparsegl` object. — coef.sparsegl","text":"","code":"# S3 method for class 'sparsegl' coef(object, s = NULL, ...)"},{"path":"https://jaredhuling.github.io/hierNest/reference/coef.sparsegl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract model coefficients from a `sparsegl` object. — coef.sparsegl","text":"object Fitted [sparsegl()] object. s Value(s) penalty parameter `lambda` coefficients required. Default entire sequence. ... used.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/coef.sparsegl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract model coefficients from a `sparsegl` object. — coef.sparsegl","text":"coefficients requested values `lambda`.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/coef.sparsegl.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract model coefficients from a `sparsegl` object. — coef.sparsegl","text":"`s` new vector `lambda` values predictions requested. `s` lambda sequence used fitting model, `coef` function use linear interpolation make predictions. new values interpolated using fraction coefficients left right `lambda` indices.","code":""},{"path":[]},{"path":"https://jaredhuling.github.io/hierNest/reference/cv.hierNest.html","id":null,"dir":"Reference","previous_headings":"","what":"Cross-validated hierarchical nested regularization for subgroup models — cv.hierNest","title":"Cross-validated hierarchical nested regularization for subgroup models — cv.hierNest","text":"Fits regularization paths hierarchical subgroup-specific penalized learning problems, leveraging nested group structure (Major Diagnostic Categories [MDC] Diagnosis-Related Groups [DRG]) options lasso overlapping group lasso penalties. Performs cross-validation select tuning parameters penalization subgroup structure. function enables information sharing across related subgroups reparameterizing covariate effects overall, group-specific, subgroup-specific components supports structured shrinkage hierarchical regularization. Users may select lasso (hierNest-Lasso) overlapping group lasso (hierNest-OGLasso) frameworks, described Jiang et al. (2024, submitted, see details ).","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/cv.hierNest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cross-validated hierarchical nested regularization for subgroup models — cv.hierNest","text":"","code":"cv.hierNest(   x,   y,   group = NULL,   family = c(\"gaussian\", \"binomial\"),   nlambda = 100,   lambda.factor = NULL,   pred.loss = c(\"default\", \"mse\", \"deviance\", \"mae\", \"misclass\", \"ROC\"),   lambda = NULL,   pf_group = NULL,   pf_sparse = NULL,   intercept = FALSE,   asparse1 = c(0.5, 20),   asparse2 = c(0.01, 0.2),   asparse1_num = 4,   asparse2_num = 4,   standardize = TRUE,   lower_bnd = -Inf,   upper_bnd = Inf,   eps = 1e-08,   maxit = 3e+06,   hier_info = NULL,   method = \"overlapping\",   partition = \"subgroup\",   cvmethod = \"general\" )"},{"path":"https://jaredhuling.github.io/hierNest/reference/cv.hierNest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cross-validated hierarchical nested regularization for subgroup models — cv.hierNest","text":"x Matrix predictors, dimension \\(n \\times p\\); row observation. Can dense sparse matrix. y Response variable. `family=\"gaussian\"`, numeric. `family=\"binomial\"`, factor two levels numeric vector two unique values. group Optional vector factor indicating group assignments variables. Used custom grouping. family Character string specifying model family. Options `\"gaussian\"` (default) least-squares regression, `\"binomial\"` logistic regression. nlambda Number lambda values use regularization path. Default 100. lambda.factor Factor determining minimal value lambda sequence, `min(lambda) = lambda.factor * max(lambda)`. See Details. pred.loss Character string indicating loss minimize cross-validation. Options include `\"default\"`, `\"mse\"`, `\"deviance\"`, `\"mae\"`, `\"misclass\"`, `\"ROC\"`. lambda Optional user-supplied sequence lambda values (overrides `nlambda`/`lambda.factor`). pf_group Optional penalty factors groups, numeric vector. Default adjusts group size. pf_sparse Optional penalty factors l1-norm (sparsity), numeric vector. intercept Logical; whether include intercept model. Default TRUE. asparse1 Relative weight(s) first (e.g., group) layer overlapping group lasso penalty. Default c(0.5, 20). asparse2 Relative weight(s) second (e.g., subgroup) layer. Default c(0.01, 0.2). asparse1_num Number values asparse1 grid (grid search). Default 4. asparse2_num Number values asparse2 grid (grid search). Default 4. standardize Logical; whether standardize predictors prior model fitting. Default TRUE. lower_bnd Lower bound(s) coefficient values. Default -Inf. upper_bnd Upper bound(s) coefficient values. Default Inf. eps Convergence tolerance optimization. Default 1e-8. maxit Maximum number optimization iterations. Default 3e6. hier_info Required `method = \"overlapping\"`; matrix describing hierarchical structure subgroups (see Details). method Character; either `\"overlapping\"` overlapping group lasso, `\"sparsegl\"` sparse group lasso, `\"general\"` hierarchical regularization. Default `\"overlapping\"`. partition Character string; determines subgroup partitioning. Default `\"subgroup\"`. cvmethod Cross-validation method. Options include `\"general\"` (default), `\"grid_search\"`, `\"user_supply\"` (user-supplied grid).","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/cv.hierNest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cross-validated hierarchical nested regularization for subgroup models — cv.hierNest","text":"object containing fitted hierarchical model cross-validation results, including: fit Fitted model object. lambda Sequence lambda values considered. cv_error Cross-validation error/loss combination tuning parameters. best_params Best tuning parameters selected. ... Additional diagnostic output fields.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/cv.hierNest.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cross-validated hierarchical nested regularization for subgroup models — cv.hierNest","text":"hierarchical nested framework decomposes covariate effects overall, group, subgroup-specific components, regularization encouraging fusion sparsity across hierarchical levels. function can fit lasso penalty (allowing arbitrary zero/non-zero patterns) overlapping group lasso penalty (enforcing hierarchical selection structure), described Jiang et al. (2024, submitted). argument `hier_info` must supplied `\"overlapping\"` method, encodes hierarchical relationship groups subgroups (e.g., MDCs DRGs). Cross-validation used select tuning parameters, optionally grid hierarchical penalty weights (asparse1, asparse2), regularization parameter lambda.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/cv.hierNest.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Cross-validated hierarchical nested regularization for subgroup models — cv.hierNest","text":"Jiang, Z., Huo, L., Hou, J., & Huling, J. D. \"Heterogeneous readmission prediction hierarchical effect decomposition regularization\".","code":""},{"path":[]},{"path":"https://jaredhuling.github.io/hierNest/reference/cv.hierNest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cross-validated hierarchical nested regularization for subgroup models — cv.hierNest","text":"","code":"library(hierNest) data(\"example_data\") # \\donttest{ cv.fit=cv.hierNest(example_data$X,                   example_data$Y,                   method=\"overlapping\",                   hier_info=example_data$hier_info,                   family=\"binomial\",                   partition = \"subgroup\",                     cvmethod = \"grid_search\",                    asparse1 = c(0.5, 1),                    asparse2 = c(0.05, 0.20),                    nlambda = 50)# }"},{"path":"https://jaredhuling.github.io/hierNest/reference/estimate_risk.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate information criteria. — estimate_risk","title":"Calculate information criteria. — estimate_risk","text":"function uses degrees freedom calculate various information criteria. function uses \"unknown variance\" version likelihood. implemented Gaussian regression. constant ignored ([stats::extractAIC()]).","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/estimate_risk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate information criteria. — estimate_risk","text":"","code":"estimate_risk(object, x, type = c(\"AIC\", \"BIC\", \"GCV\"), approx_df = FALSE)"},{"path":"https://jaredhuling.github.io/hierNest/reference/estimate_risk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate information criteria. — estimate_risk","text":"object fitted object call [sparsegl()]. x Matrix. matrix predictors used estimate `sparsegl` object. May missing `approx_df = TRUE`. type one AIC, BIC, GCV. approx_df `df` component `sparsegl` object approximation (albeit fairly accurate one) actual degrees--freedom. However, exact value requires inverting portion `X'X`. computation may take time (default computes exact df).","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/estimate_risk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate information criteria. — estimate_risk","text":"`data.frame` many rows `object$lambda`. contains   columns `lambda`, `df`, requested risk types.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/estimate_risk.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate information criteria. — estimate_risk","text":"Vaiter S, Deledalle C, Peyré G, Fadili J, Dossal C. (2012). Degrees Freedom Group Lasso General Design. https://arxiv.org/pdf/1212.6478.pdf.","code":""},{"path":[]},{"path":"https://jaredhuling.github.io/hierNest/reference/example_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Example dataset — example_data","title":"Example dataset — example_data","text":"Example dataset sample code hierNest","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/example_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example dataset — example_data","text":"","code":"data(example_data)"},{"path":"https://jaredhuling.github.io/hierNest/reference/example_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example dataset — example_data","text":"data frame X rows Y columns: X Matrix predictors Y Outcome variable hier_info Group information passed hierNest functions","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/grouped_sp_norm.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate common norms — zero_norm","title":"Calculate common norms — zero_norm","text":"Calculate different norms vectors without grouping structures.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/grouped_sp_norm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate common norms — zero_norm","text":"","code":"zero_norm(x)  one_norm(x)  two_norm(x)  grouped_zero_norm(x, gr)  grouped_one_norm(x, gr)  grouped_two_norm(x, gr)  grouped_sp_norm(x, gr, asparse)  gr_one_norm(x, gr)  gr_two_norm(x, gr)  sp_group_norm(x, gr, asparse = 0.05)"},{"path":"https://jaredhuling.github.io/hierNest/reference/grouped_sp_norm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate common norms — zero_norm","text":"x numeric vector. gr integer (factor) vector length x. asparse Scalar. weight put l1 norm calculating group norm.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/grouped_sp_norm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate common norms — zero_norm","text":"numeric scalar vector","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/grouped_sp_norm.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Calculate common norms — zero_norm","text":"zero_norm(): l0-norm (number nonzero entries). one_norm(): l1-norm (Absolute-value norm). two_norm(): l2-norm (Euclidean norm). grouped_zero_norm(): vector group-wise l0-norms. grouped_one_norm(): vector group-wise l1-norms. grouped_two_norm(): vector group-wise l2-norms. grouped_sp_norm(): vector length `unique(gr)` consisting `asparse` convex combination l1 l2-norm group. gr_one_norm(): l1-norm norm vector (scalar). gr_two_norm(): sum group-wise l2-norms vector (scalar). sp_group_norm(): sum `asparse` convex combination group l1 l2-norms vectors (scalar).","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/hierNest-package.html","id":null,"dir":"Reference","previous_headings":"","what":"hierNest: Penalized Regression with Hierarchical Nested Parameterization Structure — hierNest-package","title":"hierNest: Penalized Regression with Hierarchical Nested Parameterization Structure — hierNest-package","text":"Efficient implementation penalized regression hierarchical nested parametrization grouped data. package provides penalized regression methods decompose subgroup-specific covariate effects shared global effects, Major subgroup–specific effects, Minor subgroup–specific effects, enabling structured borrowing information across related clinical subgroups. lasso hierarchical overlapping group lasso penalties supported encourage sparsity respecting nested subgroup structure. Efficient computation achieved modified design matrix representation custom majorization–minimization algorithm overlapping group penalties.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/hierNest-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"hierNest: Penalized Regression with Hierarchical Nested Parameterization Structure — hierNest-package","text":"Maintainer: Ziren Jiang jian0746@umn.edu Authors: Jared Huling huling@umn.edu Jue Hou hou00123@umn.edu Lingfeng Huo contributors: Daniel J. McDonald [contributor] Xiaoxuan Liang [contributor] Anibal Solón Heinsfeld [contributor] Aaron Cohen [contributor] Yi Yang [contributor] Hui Zou [contributor] Jerome Friedman [contributor] Trevor Hastie [contributor] Rob Tibshirani [contributor] Balasubramanian Narasimhan [contributor] Kenneth Tay [contributor] Noah Simon [contributor] Junyang Qian [contributor] James Yang [contributor]","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/hierNest.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit Hierarchical Nested Regularization Model (hierNest) — hierNest","title":"Fit Hierarchical Nested Regularization Model (hierNest) — hierNest","text":"Fits hierarchical nested penalized regression model subgroup-specific effects using overlapping group lasso penalties. function encodes hierarchical structure (e.g., MDC DRG) via reparameterized design matrix enables information borrowing across related subgroups.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/hierNest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit Hierarchical Nested Regularization Model (hierNest) — hierNest","text":"","code":"hierNest(   x,   y,   group = NULL,   family = c(\"gaussian\", \"binomial\"),   nlambda = 100,   lambda.factor = NULL,   lambda = NULL,   pf_group = NULL,   pf_sparse = NULL,   intercept = FALSE,   asparse1 = 1,   asparse2 = 0.05,   standardize = TRUE,   lower_bnd = -Inf,   upper_bnd = Inf,   eps = 1e-08,   maxit = 3e+06,   hier_info = NULL,   random_asparse = FALSE,   method = \"overlapping\" )"},{"path":"https://jaredhuling.github.io/hierNest/reference/hierNest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit Hierarchical Nested Regularization Model (hierNest) — hierNest","text":"x Matrix predictors (\\(n \\times p\\)), row observation. y Response variable (numeric \"gaussian\", binary factor \"binomial\"). group Optional grouping vector (required \"overlapping\" method). family Model family; either \"gaussian\" least squares \"binomial\" logistic regression. nlambda Number lambda values regularization path (default: 100). lambda.factor Factor minimal value lambda sequence. lambda Optional user-supplied lambda sequence. pf_group Penalty factor(s) group; defaults sqrt(group size). pf_sparse Penalty factors individual predictors (L1 penalty). intercept Logical; intercept included? Default FALSE. asparse1 Relative weight group-level penalty (default: 1). asparse2 Relative weight subgroup-level penalty (default: 0.05). standardize Logical; standardize predictors? Default TRUE. lower_bnd Lower bound coefficients (default: -Inf). upper_bnd Upper bound coefficients (default: Inf). eps Convergence tolerance (default: 1e-8). maxit Maximum number optimization iterations (default: 3e6). hier_info Required. Matrix encoding hierarchical structure (see Details). random_asparse Logical; use random sparse penalty? Default: FALSE. method Type hierarchical regularization (\"overlapping\" [default], \"sparsegl\", \"general\").","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/hierNest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit Hierarchical Nested Regularization Model (hierNest) — hierNest","text":"Returns model fit object produced hierNest::overlapping_gl, including selected coefficients, cross-validation results, tuning parameters.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/hierNest.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit Hierarchical Nested Regularization Model (hierNest) — hierNest","text":"function builds hierarchical design matrix reflecting group/subgroup structure (e.g., Major Diagnostic Categories [MDCs] Diagnosis Related Groups [DRGs]), encoding overall, group-specific, subgroup-specific effects. fits penalized model using overlapping group lasso, described Jiang et al. (2024, submitted). main computational engine hierNest::overlapping_gl.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/hierNest.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fit Hierarchical Nested Regularization Model (hierNest) — hierNest","text":"Jiang, Z., Huo, L., Hou, J., Vaughan-Sarrazin, M., Smith, M. ., & Huling, J. D. (2024). Heterogeneous readmission prediction hierarchical effect decomposition regularization.","code":""},{"path":[]},{"path":"https://jaredhuling.github.io/hierNest/reference/hierNest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit Hierarchical Nested Regularization Model (hierNest) — hierNest","text":"","code":"# Example with toy data library(hierNest) data(\"example_data\") # \\donttest{ fit = hierNest(example_data$X,               example_data$Y,               hier_info=example_data$hier_info,               family=\"binomial\",               asparse1 = 1,               asparse2 = 1)# }"},{"path":"https://jaredhuling.github.io/hierNest/reference/make_irls_warmup.html","id":null,"dir":"Reference","previous_headings":"","what":"Create starting values for iterative reweighted least squares — make_irls_warmup","title":"Create starting values for iterative reweighted least squares — make_irls_warmup","text":"function may used create potentially valid starting values calling [sparsegl()] [stats::family()] object. typically necessary call function (used internally create ), cases, especially custom generalized linear models, may improve performance.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/make_irls_warmup.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create starting values for iterative reweighted least squares — make_irls_warmup","text":"","code":"make_irls_warmup(nobs, nvars, b0 = 0, beta = double(nvars), r = double(nobs))"},{"path":"https://jaredhuling.github.io/hierNest/reference/make_irls_warmup.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create starting values for iterative reweighted least squares — make_irls_warmup","text":"nobs Number observations response (rows `x`). nvars Number columns `x` b0 Scalar. Initial value intercept. beta Vector. Initial values coefficients. Must length `nvars` (scalar). r Vector. Initial values deviance residuals. Must length `nobs` (scalar).","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/make_irls_warmup.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create starting values for iterative reweighted least squares — make_irls_warmup","text":"List class `irlsspgl_warmup`","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/make_irls_warmup.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create starting values for iterative reweighted least squares — make_irls_warmup","text":"Occasionally, irls fitting routine may fail admonition create valid starting values.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/overlapping_gl.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit an Overlapping Group Lasso Model — overlapping_gl","title":"Fit an Overlapping Group Lasso Model — overlapping_gl","text":"function fits overlapping group lasso model hierarchical regularization, allowing sparsity within groups across groups.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/overlapping_gl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit an Overlapping Group Lasso Model — overlapping_gl","text":"","code":"overlapping_gl(   x,   y,   group = NULL,   family = c(\"gaussian\", \"binomial\"),   nlambda = 100,   lambda.factor = ifelse(nobs < nvars, 0.01, 1e-04),   lambda = NULL,   pf_group = sqrt(bs),   pf_sparse = rep(1, nvars),   intercept = TRUE,   asparse1 = 1,   asparse2 = 0.05,   standardize = TRUE,   lower_bnd = -Inf,   upper_bnd = Inf,   weights = NULL,   offset = NULL,   warm = NULL,   trace_it = 0,   dfmax = as.integer(max(group)) + 1L,   pmax = min(dfmax * 1.2, as.integer(max(group))),   eps = 1e-08,   maxit = 3e+06,   cn,   drgix,   drgiy,   cn_s,   cn_e,   random_asparse = FALSE )"},{"path":"https://jaredhuling.github.io/hierNest/reference/overlapping_gl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit an Overlapping Group Lasso Model — overlapping_gl","text":"x numeric matrix predictor variables (missing values allowed). y numeric vector response variable values. group integer vector defining group membership predictor. Default NULL (predictor forms group). family character string specifying model family. Options \"gaussian\" (default) \"binomial\". nlambda Number lambda values. Default 100. lambda.factor Factor determining minimum lambda fraction maximum lambda. Default depends dimensionality. lambda Numeric vector lambda values. provided, overrides `nlambda` `lambda.factor`. pf_group Penalty factor groups. Default square root group size. pf_sparse Penalty factor individual predictors. Default 1 predictor. intercept Logical; whether include intercept. Default TRUE. asparse1 Sparsity penalty factor controlling group-level sparsity. Default 1. asparse2 Sparsity penalty factor controlling within-group sparsity. Default 0.05. standardize Logical; TRUE, standardizes predictors fitting. Default TRUE. lower_bnd Numeric vector specifying lower bounds coefficients. Default -Inf. upper_bnd Numeric vector specifying upper bounds coefficients. Default Inf. weights Optional numeric vector observation weights. Currently limited functionality. offset Optional numeric vector specifying known component included linear predictor. warm Optional initial values optimization. trace_it Integer indicating verbosity level. Default 0 (output). dfmax Maximum number groups allowed model. Default derived groups. pmax Maximum number predictors allowed model. Default derived groups. eps Numeric convergence threshold optimization. Default 1e-08. maxit Maximum number iterations optimization. Default 3e+06. cn Additional internal numeric parameter optimization. drgix, drgiy Numeric vectors specifying indices specific group predictor structures. cn_s, cn_e Numeric vectors specifying starting ending indices substructures. random_asparse Logical; TRUE, randomly selects sparsity parameters. Default FALSE.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/overlapping_gl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit an Overlapping Group Lasso Model — overlapping_gl","text":"object class `sparsegl` containing: call matched function call. lambda lambda values used fitting. asparse1, asparse2 Sparsity parameters used. nobs Number observations. pf_group, pf_sparse Penalty factors used. coefficients Estimated coefficients. Additional components relevant model diagnostics fitting.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://jaredhuling.github.io/hierNest/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling `rhs(lhs)`.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/plot.cv.hierNest.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot method for cv.hierNest objects — plot.cv.hierNest","title":"Plot method for cv.hierNest objects — plot.cv.hierNest","text":"Plot method cv.hierNest objects","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/plot.cv.hierNest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot method for cv.hierNest objects — plot.cv.hierNest","text":"","code":"# S3 method for class 'cv.hierNest' plot(x, type = c(\"coefficients\", \"Subgroup effects\"), ...)"},{"path":"https://jaredhuling.github.io/hierNest/reference/plot.cv.hierNest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot method for cv.hierNest objects — plot.cv.hierNest","text":"x object class cv.hierNest type Plot type, e.g. \"fit\" observed vs fitted (default), others may add later (e.g., \"coef\"). ... parameters","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/plot.cv.hierNest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot method for cv.hierNest objects — plot.cv.hierNest","text":"Invisibly returns x","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/predict.cv.sparsegl.html","id":null,"dir":"Reference","previous_headings":"","what":"Make predictions from a `cv.sparsegl` object. — predict.cv.sparsegl","title":"Make predictions from a `cv.sparsegl` object. — predict.cv.sparsegl","text":"function makes predictions cross-validated [cv.sparsegl()] object, using stored `sparsegl.fit` object, value chosen `lambda`.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/predict.cv.sparsegl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make predictions from a `cv.sparsegl` object. — predict.cv.sparsegl","text":"","code":"# S3 method for class 'cv.sparsegl' predict(   object,   newx,   s = c(\"lambda.1se\", \"lambda.min\"),   type = c(\"link\", \"response\", \"coefficients\", \"nonzero\", \"class\"),   ... )"},{"path":"https://jaredhuling.github.io/hierNest/reference/predict.cv.sparsegl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make predictions from a `cv.sparsegl` object. — predict.cv.sparsegl","text":"object Fitted [cv.sparsegl()] object. newx Matrix new values `x` predictions made. Must matrix. argument mandatory. s Value(s) penalty parameter `lambda` coefficients desired. Default single value `s = \"lambda.1se\"` stored CV object (corresponding largest value `lambda` CV error estimate within 1 standard error minimum). Alternatively `s = \"lambda.min\"` can used (corresponding minimum cross validation error estimate). `s` numeric, taken value(s) `lambda` used. type Type prediction required. Type `\"link\"` gives linear predictors `\"binomial\"`; `\"gaussian\"` models gives fitted values. Type `\"response\"` gives predictions scale response (example, fitted probabilities `\"binomial\"`); `\"gaussian\"` type `\"response\"` equivalent type `\"link\"`. Type `\"coefficients\"` computes coefficients requested values `s`. Type `\"class\"` applies `\"binomial\"` models, produces class label corresponding maximum probability. Type `\"nonzero\"` returns list indices nonzero coefficients value s. ... used.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/predict.cv.sparsegl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make predictions from a `cv.sparsegl` object. — predict.cv.sparsegl","text":"matrix vector predicted values.","code":""},{"path":[]},{"path":"https://jaredhuling.github.io/hierNest/reference/predict.sparsegl.html","id":null,"dir":"Reference","previous_headings":"","what":"Make predictions from a `sparsegl` object. — predict.sparsegl","title":"Make predictions from a `sparsegl` object. — predict.sparsegl","text":"Similar predict methods, function produces fitted values class labels fitted [`sparsegl`] object.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/predict.sparsegl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make predictions from a `sparsegl` object. — predict.sparsegl","text":"","code":"# S3 method for class 'sparsegl' predict(   object,   newx,   s = NULL,   type = c(\"link\", \"response\", \"coefficients\", \"nonzero\", \"class\"),   ... )"},{"path":"https://jaredhuling.github.io/hierNest/reference/predict.sparsegl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make predictions from a `sparsegl` object. — predict.sparsegl","text":"object Fitted [sparsegl()] model object. newx Matrix new values `x` predictions made. Must matrix. argument mandatory. s Value(s) penalty parameter `lambda` predictions required. Default entire sequence used create model. type Type prediction required. Type `\"link\"` gives linear predictors `\"binomial\"`; `\"gaussian\"` models gives fitted values. Type `\"response\"` gives predictions scale response (example, fitted probabilities `\"binomial\"`); `\"gaussian\"` type `\"response\"` equivalent type `\"link\"`. Type `\"coefficients\"` computes coefficients requested values `s`. Type `\"class\"` applies `\"binomial\"` models, produces class label corresponding maximum probability. Type `\"nonzero\"` returns list indices nonzero coefficients value s. ... used.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/predict.sparsegl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make predictions from a `sparsegl` object. — predict.sparsegl","text":"object returned depends type.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/predict.sparsegl.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Make predictions from a `sparsegl` object. — predict.sparsegl","text":"`s` new vector `lambda` values predictions requested. `s` lambda sequence used fitting model, `coef` function use linear interpolation make predictions. new values interpolated using fraction coefficients left right `lambda` indices.","code":""},{"path":[]},{"path":"https://jaredhuling.github.io/hierNest/reference/predict_hierNest.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict Method for hierNest Objects — predict_hierNest","title":"Predict Method for hierNest Objects — predict_hierNest","text":"Provides predictions fitted hierarchical model (`hierNest`) using new data.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/predict_hierNest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict Method for hierNest Objects — predict_hierNest","text":"","code":"predict_hierNest(   object,   newx,   hier_info,   type = c(\"link\", \"response\", \"coefficients\", \"nonzero\", \"class\"),   ... )"},{"path":"https://jaredhuling.github.io/hierNest/reference/predict_hierNest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict Method for hierNest Objects — predict_hierNest","text":"object fitted hierNest model object. newx numeric matrix new predictor values prediction. hier_info numeric matrix hierarchical grouping information. First column MDC-level grouping; second column DRG-level grouping. type Character string specifying type prediction required. Options include \"link\", \"response\", \"coefficients\", \"nonzero\", \"class\". ... Additional arguments passed lower-level prediction methods.","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/predict_hierNest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict Method for hierNest Objects — predict_hierNest","text":"Predictions based specified `type`. Typically, returns: Numeric vector matrix predicted values (\"link\" \"response\"). Model coefficients (\"coefficients\"). Nonzero coefficient indices (\"nonzero\"). Class labels categorical outcomes (\"class\").","code":""},{"path":"https://jaredhuling.github.io/hierNest/reference/predict_hierNest.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict Method for hierNest Objects — predict_hierNest","text":"function prepares hierarchical design matrix based `hier_info`, constructs required Khatri-Rao product, reorganizes generating predictions provided `object`.","code":""}]
